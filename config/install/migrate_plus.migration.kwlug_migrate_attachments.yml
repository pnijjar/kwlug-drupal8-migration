uuid: 8875fdee-d39f-11e6-86ac-43c2ccc922b8
langcode: en
status: true
dependencies: {  }
id: kwlug_migrate_attachments
migration_tags:
  - 'Drupal 6'
migration_group: NO_kwlug_migrate
label: 'File uploads (attachments)'
source:
  plugin: d6_debug_upload
process:
  nid:
    plugin: migration
    migration: kwlug_migrate_dummy_merged_presentations
    source: value
    #  - upgrade_d6_node_agenda
    #  - upgrade_d6_node_blog
    #  - upgrade_d6_node_book
    #  - upgrade_d6_node_page
    #  - upgrade_d6_node_presentation
    #source_ids:
    #  kwlug_migrate_dummy_merged_presentations:
    #    - agenda_nid
    #  upgrade_d6_node_agenda:
    #    - nid
    #  upgrade_d6_node_blog:
    #    - nid
    #  upgrade_d6_node_book:
    #    - nid
    #  upgrade_d6_node_page:
    #    - nid
    #  upgrade_d6_node_presentation:
    #    - nid
  # vid: vid
  type: 
    plugin: static_map 
    source: type
    map: 
      page: page
      podcast: podcast
      nominee: nominee
      blog: page
      book: page
      agenda: agenda
      # This is wrong if any orphaned presentations have agendas
      presentation: agenda
  field_file_attachments: 
    plugin: iterator
    source: upload
    process:
      target_id:
        plugin: migration
        migration: upgrade_d6_file
        source: fid
      display: list
      description: description
destination:
  plugin: 'entity:node'
migration_dependencies:
  required:
    0: upgrade_d6_file
    10: upgrade_d6_node_type
    73: upgrade_d6_node_agenda
    74: upgrade_d6_node_blog
    75: upgrade_d6_node_book
    77: upgrade_d6_node_location
    78: upgrade_d6_node_nominee
    79: upgrade_d6_node_page
    81: upgrade_d6_node_presentation
    #76: upgrade_d6_node_image
    #80: upgrade_d6_node_podcast
    #82: upgrade_d6_node_profile
    #83: upgrade_d6_node_story
    #84: upgrade_d6_upload_field_instance
    
  optional:
    - upgrade_d6_file
